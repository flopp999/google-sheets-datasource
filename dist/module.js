define(["react","@grafana/ui","@grafana/data","@grafana/runtime"],(function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=4)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";n.r(t);var r=n(2),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function o(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function s(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var u,l=n(3),c=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.testDatasource=function(){return e=this,t=void 0,r=function(){return s(this,(function(e){return[2,Object(l.getBackendSrv)().post("/api/ds/query",{from:"5m",to:"now",queries:[{refId:"A",datasource:this.name,datasourceId:this.id,intervalMs:1,maxDataPoints:1,queryType:"testAPI"}]}).then((function(e){return{status:"success",message:"Success"}}))]}))},new((n=void 0)||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(i,s)}u((r=r.apply(e,t||[])).next())}));var e,t,n,r},t}(l.DataSourceWithBackend),p=n(0),f=n.n(p),d=n(1);!function(e){e.DIMENSION_UNSPECIFIED="DIMENSION_UNSPECIFIED",e.ROWS="ROWS",e.COLUMNS="COLUMNS"}(u||(u={}));var h,m=[{label:"Rows",value:u.ROWS},{label:"Columns",value:u.COLUMNS}];!function(e){e.JWT="jwt",e.GCE="gce",e.NONE="none"}(h||(h={}));var g=[{label:"None (public)",value:h.NONE},{label:"Google JWT File",value:h.JWT},{label:"GCE Default Service Account",value:h.GCE}],y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onResetApiKey=function(){var e=t.props.options;t.props.onOptionsChange(i(i({},e),{secureJsonData:i(i({},e.secureJsonData),{apiKey:""}),secureJsonFields:i(i({},e.secureJsonFields),{apiKey:!1})}))},t}return o(t,e),t.prototype.render=function(){var e,t=this,n=this.props.options,a=n.secureJsonFields,o=n.jsonData,s=n.secureJsonData;return f.a.createElement("div",{className:"gf-form-group"},f.a.createElement("div",{className:"gf-form"},f.a.createElement(d.FormLabel,{className:"width-10"},"Auth Provider"),f.a.createElement(d.Select,{className:"width-30",value:g.find((function(e){return e.value===o.authType}))||g[0],options:g,defaultValue:n.jsonData.authType,onChange:Object(r.onUpdateDatasourceJsonDataOptionSelect)(this.props,"authType")})),o.authType===h.NONE&&f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"gf-form"},f.a.createElement(d.SecretFormField,{isConfigured:a&&a.apiKey,value:(null===(e=s)||void 0===e?void 0:e.apiKey)||"",label:"API Key",labelWidth:10,inputWidth:25,placeholder:"Enter API Key",onReset:this.onResetApiKey,onChange:Object(r.onUpdateDatasourceSecureJsonDataOption)(this.props,"apiKey")})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(d.FormField,{label:"API Key (temp)",labelWidth:10,inputWidth:25,placeholder:"Enter API Key",onChange:function(e){return t.props.onOptionsChange(i(i(i({},t.props),t.props.options),{jsonData:i(i({},t.props.options.jsonData),{apiKey:e.target.value})}))}}))),o.authType===h.JWT&&f.a.createElement("textarea",{onPaste:function(e){return Object(r.onUpdateDatasourceJsonDataOptionSelect)(t.props,"jwtFile")({value:e.clipboardData.getData("text/plain")})},placeholder:"Paste your Google JWT file content here",className:"gf-form-input",style:{height:200}},o.jwtFile))},t}(p.PureComponent);function v(e){var t,n=null===(t=e)||void 0===t?void 0:t.indexOf("/d/");if(!n)return{spreadsheetId:e};var r=e.substring(n+3);return(n=r.indexOf("/"))&&(r=r.substring(0,n)),(n=e.indexOf("range="))>0?{spreadsheetId:r,range:e.substring(n+"range=".length)}:{spreadsheetId:r}}var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSpreadsheetIdPasted=function(e){var n=e.clipboardData.getData("text/plain");if(n){var r=v(n);r.spreadsheetId&&(console.log("PASTED",n,r),r.spreadsheetId=r.spreadsheetId+"»",t.props.onChange(i(i({},t.props.query),r)),console.log("UPDATED",r))}},t.onSpreadsheetIdChange=function(e){console.log("CHANGE",e.target.value);var n=e.target.value,r=n.indexOf("»");r>0&&(n=n.substring(0,r)),t.props.onChange(i(i({},t.props.query),{spreadsheetId:n}))},t.onRangeChange=function(e){t.props.onChange(i(i({},t.props.query),{range:e.target.value}))},t}return o(t,e),t.prototype.componentWillMount=function(){this.props.query.queryType||(this.props.query.queryType="query")},t.prototype.render=function(){var e,t,n=this.props,r=n.query,a=n.onRunQuery,o=n.onChange;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"gf-form-inline"},f.a.createElement(d.FormLabel,{width:8,className:"query-keyword"},"Spreadsheet ID"),f.a.createElement("input",{className:"gf-form-input width-28",placeholder:"Enter ID from URL",value:r.spreadsheetId||"",onPaste:this.onSpreadsheetIdPasted,onChange:this.onSpreadsheetIdChange,onBlur:a}),f.a.createElement(d.LinkButton,{disabled:!r.spreadsheetId,variant:"secondary",icon:"fa fa-link",href:(e=r,t="https://docs.google.com/spreadsheets/d/"+e.spreadsheetId+"/view",e.range&&(t+="#range="+e.range),t),target:"_blank"}),f.a.createElement("div",{className:"gf-form gf-form--grow"},f.a.createElement("div",{className:"gf-form-label gf-form-label--grow"}))),f.a.createElement("div",{className:"gf-form-inline"},f.a.createElement(d.FormLabel,{width:8,className:"query-keyword"},"Range"),f.a.createElement("input",{className:"gf-form-input width-14",value:r.range||"",placeholder:"ie: Class Data!A2:E",onChange:this.onRangeChange,onBlur:a}),f.a.createElement(d.FormLabel,{width:10,className:"query-keyword"},"Major Dimension"),f.a.createElement(d.Segment,{options:m,value:m.find((function(e){return e.value===r.majorDimension}))||m[0],onChange:function(e){var t=e.value;o(i(i({},r),{majorDimension:t})),a()}}),f.a.createElement("div",{className:"gf-form gf-form--grow"},f.a.createElement("div",{className:"gf-form-label gf-form-label--grow"}))))},t}(p.PureComponent);n.d(t,"plugin",(function(){return E}));var E=new r.DataSourcePlugin(c).setConfigEditor(y).setQueryEditor(b)}])}));